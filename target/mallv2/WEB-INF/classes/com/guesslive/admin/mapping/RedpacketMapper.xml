<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.guesslive.admin.dao.RedpacketMapper">

	<insert id="insertPacket" useGeneratedKeys="true" keyProperty="id">
		insert into t_redpacket
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="title != null">
				title,
			</if>
			<if test="money != null">
				money,
			</if>
			<if test="threshold != null">
				threshold,
			</if>
			<if test="endtime != null">
				endtime,
			</if>
			<if test="total != null">
				total,
			</if>
			<if test="storage != null">
				storage,
			</if>
			<if test="validTimeType != null">
				validTimeType,
			</if>
			<if test="fixedTerm != null">
				fixedTerm,
			</if>
			<if test="fixedBeginTerm != null">
				fixedBeginTerm,
			</if>
			<if test="consumeType != null">
				consumeType,
			</if>
			<if test="status != null">
				status,
			</if>
			<if test="push != null">
				push,
			</if>
			<if test="createtime != null">
				createtime,
			</if>
			<if test="limits != null">
				limits,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="title != null">
				#{title},
			</if>
			<if test="money != null">
				#{money},
			</if>
			<if test="threshold != null">
				#{threshold},
			</if>
			<if test="endtime != null">
				#{endtime},
			</if>
			<if test="total != null">
				#{total},
			</if>
			<if test="storage != null">
				#{storage},
			</if>
			<if test="validTimeType != null">
				#{validTimeType},
			</if>
			<if test="fixedTerm != null">
				#{fixedTerm},
			</if>
			<if test="fixedBeginTerm != null">
				#{fixedBeginTerm},
			</if>
			<if test="consumeType != null">
				#{consumeType},
			</if>
			<if test="status != null">
				#{status},
			</if>
			<if test="push != null">
				#{push},
			</if>
			<if test="createtime != null">
				#{createtime},
			</if>
			<if test="limits != null">
				#{limits},
			</if>
		</trim>
	</insert>

	<select id="selectAll" resultType="Redpacket">
		select
		* from t_redpacket
		<where>
			and status = 0
			<if test="packet.money != '' and packet.money != null">
				and money &lt;= #{packet.money}
			</if>
			<if test="packet.title != '' and packet.title != null">
				and title like '%${packet.title}%'
			</if>
			<if test="packet.total != '' and packet.total != null">
				and total &lt;= #{packet.total}
			</if>
		</where>
		order by id DESC
		limit #{start},#{rows}
	</select>

	<select id="selectTotal" resultType="int">
		select count(*) from t_redpacket
		<where>
			and status = 0
			<if test="money != '' and money != null">
				and money &lt;= #{money}
			</if>
			<if test="title != '' and title != null">
				and title like '%${title}%'
			</if>
			<if test="total != '' and total != null">
				and total &lt;= #{total}
			</if>
		</where>
	</select>

	<!-- 根据id修改商城卡券信息 -->
	<update id="updateRedpacket" parameterType="Redpacket">
		UPDATE t_redpacket
		<set>
			<if test="status != null and status != '' ">
				status = #{status},
			</if>
			<if test="push != null and push != '' ">
				push = #{push},
			</if>
		</set>
		where id = #{id}
	</update>
	
</mapper>